var jsPsychExternalHtml=function(e){"use strict";function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n={name:"external-html",parameters:{url:{type:e.ParameterType.STRING,pretty_name:"URL",default:void 0},cont_key:{type:e.ParameterType.KEY,pretty_name:"Continue key",default:null},cont_btn:{type:e.ParameterType.STRING,pretty_name:"Continue button",default:null},check_fn:{type:e.ParameterType.FUNCTION,pretty_name:"Check function",default:function(){return!0}},force_refresh:{type:e.ParameterType.BOOL,pretty_name:"Force refresh",default:!1},execute_script:{type:e.ParameterType.BOOL,pretty_name:"Execute scripts",default:!1}}},r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jsPsych=t}var n,r,a;return n=e,(r=[{key:"trial",value:function(e,t,n){var r,a=this,i=t.url;return t.force_refresh&&(i=t.url+"?t="+performance.now()),fetch(i).then((function(e){return e.text()})).then((function(i){e.innerHTML=i,n();var c=performance.now(),o=function(e){a.jsPsych.pluginAPI.compareKeys(e.key,t.cont_key)&&s()},s=function(){if(!t.check_fn||t.check_fn(e)){t.cont_key&&e.removeEventListener("keydown",o);var n={rt:Math.round(performance.now()-c),url:t.url};e.innerHTML="",a.jsPsych.finishTrial(n),r()}};if(t.execute_script)for(var u=e.getElementsByTagName("script"),l=0;l<u.length;l++){var y=document.createElement("script"),f=u[l];y.text=f.text,f.parentNode.replaceChild(y,f)}t.cont_btn&&e.querySelector("#"+t.cont_btn).addEventListener("click",s),t.cont_key&&e.addEventListener("keydown",o)})).catch((function(e){console.error("Something went wrong with fetch() in plugin-external-html.",e)})),new Promise((function(e){r=e}))}},{key:"simulate",value:function(e,t,n,r){"data-only"==t&&(r(),this.simulate_data_only(e,n)),"visual"==t&&this.simulate_visual(e,n,r)}},{key:"create_simulation_data",value:function(e,t){var n={url:e.url,rt:this.jsPsych.randomization.sampleExGaussian(2e3,200,.005,!0)},r=this.jsPsych.pluginAPI.mergeSimulationData(n,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,r),r}},{key:"simulate_data_only",value:function(e,t){var n=this.create_simulation_data(e,t);this.jsPsych.finishTrial(n)}},{key:"simulate_visual",value:function(e,t,n){var r=this,a=this.create_simulation_data(e,t),i=this.jsPsych.getDisplayElement();this.trial(i,e,(function(){n(),e.cont_key?r.jsPsych.pluginAPI.pressKey(e.cont_key,a.rt):e.cont_btn&&r.jsPsych.pluginAPI.clickTarget(i.querySelector("#"+e.cont_btn),a.rt)}))}}])&&t(n.prototype,r),a&&t(n,a),Object.defineProperty(n,"prototype",{writable:!1}),e}();return r.info=n,r}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
